@using TesisProj.Areas.Modelo.Models
@model List<TesisProj.Areas.Modelo.Models.Operacion>

@{
    ViewBag.Title = "Resultados";
    Layout = "~/Views/Shared/_Layout.cshtml";
    int Horizonte = ViewBag.Horizonte;
    int Inicio = (ViewBag.Inicio > 0 ? ViewBag.Inicio : 1) - 1;
    string format;
}

<h2>@ViewBag.Salida (@ViewBag.Proyecto)</h2>
<div style="overflow: auto; height: 600px">
<table class="table table-hover table-striped table-bordered">
    <tr>
        <th>
            Concepto
        </th>
        @for (int periodo = 1; periodo <= Horizonte; periodo++)
        {
            <th style="text-align:center; width:80px;">
                @periodo
            </th>
        }
    </tr>

@foreach (var salida in Model)
{
    <tr class = "@GetClassFromLevel(salida.Indicador, salida.Subrayar)">
        <td>
            @salida.Nombre
        </td>
        @for (int periodo = Inicio; (periodo < salida.Valores.Count) && (periodo < Horizonte); periodo++)
        {
            <td style="text-align:right;">
                @if(salida.Indicador){
                    if (periodo == Inicio){
                        if (salida.Referencia.Equals("TIRE") || salida.Referencia.Equals("TIRF") || salida.Referencia.Equals("KE") || salida.Referencia.Equals("KF"))
                        {
                            format = "{0:P2}";
                        }
                        else
                        {
                            format = "{0:#,##0}";
                        }
                        @String.Format(format, salida.Valores[0])
                    }
                } 
                else 
                {
                    @String.Format("{0:#,##0}", salida.Valores[periodo])
                }
            </td>
        }
    </tr>
}

</table>
</div>
<div>
    @Html.ActionLink("Regresar", "Cine", new { id = ViewBag.IdProyecto })
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}

@functions{ 
  public string GetClassFromLevel(bool indicador, bool subrayar) 
    {
        return subrayar ? "info" : (indicador ? "success" : "");
  }
}