@using Telerik.Web.Mvc.UI;
@model TesisProj.Areas.IridiumTest.Models.Continuous._Normal
@{
    ViewBag.Title = "Normal";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>@Model.Titulo <a href=@(Model.link) >
    <img alt="@Model.Formulates[0].NombreFormula" src="@Url.Action("getImg", "Normal", new { Id = -1 })" height="80" width="100" class="item"></img></a></h2>
<div class="row-fluid">
    <div class="span12">
        @Html.TextAreaFor(m => m.Definicion, new { style = "width:100%" })
    </div>
</div>
<div class="row-fluid">
    <div class="span4">
        @*Parametros*@
        <div class="row-fluid">
            <div class="span12">
                <div class="portlet box black">
                    <div class="portlet-title">
                        <h4>Parametros</h4>
                        @using (Html.BeginForm("Index2", "Normal", FormMethod.Post, new { @class = "form-horizontal", Id = "form1" }))
                        {
                            @Html.ValidationSummary(true)
                            <div class="portlet-body">
                                
                                    @{if (Model.ParamsIN[0].valorD>0.0){
                                        <div class="row-fluid">
                                            <div class="span3">@Model.ParamsIN[0].nombre</div>
                                            <div class="span3">@Html.Telerik().NumericTextBoxFor(m => m.ParamsIN[0].valorD).InputHtmlAttributes(new { style = "width: 50px;" }).MinValue(0).IncrementStep(0.01)</div>
                                            <div class="span3">@Model.ParamsIN[0].rango</div>
                                            <div class="span3"></div>
                                        </div>
                                        <div class="row-fluid">
                                            <div class="span3">@Model.ParamsIN[1].nombre</div>
                                            <div class="span3">@Html.Telerik().NumericTextBoxFor(m => m.ParamsIN[1].valorD).InputHtmlAttributes(new { style = "width: 50px;" }).MinValue(0).IncrementStep(0.01)</div>
                                            <div class="span3">@Model.ParamsIN[1].rango</div>
                                            <div class="span3"></div>
                                        </div>
                                    }else
                                    {
                                          <div class="row-fluid" style="visibility: hidden">
                                            <div class="span3">@Model.ParamsIN[0].nombre</div>
                                            <div class="span3">@Html.Telerik().NumericTextBoxFor(m => m.ParamsIN[0].valorD).InputHtmlAttributes(new { style = "width: 50px;" }).MinValue(0).IncrementStep(0.01)</div>
                                            <div class="span3">@Model.ParamsIN[0].rango</div>
                                            <div class="span3"></div>
                                        </div>

                                      }}
                                
                                <br />
                                <div class="row-fluid">
                                    <div class="span3">@Model.ParamsIN[2].nombre</div>
                                    <div class="span3">@Html.Telerik().NumericTextBoxFor(m => m.ParamsIN[2].valorI).InputHtmlAttributes(new { style = "width: 50px;" }).MinValue(0).IncrementStep(1)</div>
                                    <div class="span3">@Model.ParamsIN[2].rango</div>
                                    <div class="span3"></div>
                                </div>
                                <div class="row-fluid">
                                    <div class="span3">Desde</div>
                                    <div class="span3">Hasta</div>
                                    <div class="span3">% Frecuencia (< 1.00)</div>
                                    <div class="span3"></div>
                                </div>
                                <div id="div1" class="row-fluid" style="display: normal">
                                    <div class="span3">
                                        <input id="D1" type="text" style="width: 50%" /></div>
                                    <div class="span3">
                                        <input id="H1" type="text" style="width: 50%" /></div>
                                    <div class="span3">
                                        <input id="F1" onfocus="Verificar(1)" type="text" style="width: 50%" value="0.0"/></div>
                                    <div class="span3" id="B1"><a href="javascript:void(0)" class="btn btn-inverse" onclick="Cambiar(1,2)" style="color: #E6F0F2">+</a></div>
                                </div>
                                <div id="div2" class="row-fluid" style="display: none">
                                    <div class="span3">
                                        <input id="D2" disabled="disabled"  type="text" style="width: 50%" /></div>
                                    <div class="span3">
                                        <input id="H2" type="text" style="width: 50%" /></div>
                                    <div class="span3">
                                        <input id="F2" onfocus="Verificar(2)" type="text" style="width: 50%" value="0.0"/></div>
                                    <div class="span3" id="B2"><a href="javascript:void(0)" class="btn btn-inverse" onclick="Cambiar(2,3)" style="color: #E6F0F2">+</a></div>
                                </div>
                                <div id="div3" class="row-fluid" style="display: none">
                                    <div class="span3">
                                        <input id="D3" disabled="disabled"  type="text" style="width: 50%" /></div>
                                    <div class="span3">
                                        <input id="H3" type="text" style="width: 50%" /></div>
                                    <div class="span3">
                                        <input id="F3" onfocus="Verificar(3)" type="text" style="width: 50%" value="0.0"/></div>
                                    <div class="span3" id="B3"><a href="javascript:void(0)" class="btn btn-inverse" onclick="Cambiar(3,4)" style="color: #E6F0F2">+</a></div>
                                </div>
                                <div id="div4" class="row-fluid" style="display: none">
                                    <div class="span3">
                                        <input id="D4" disabled="disabled"  type="text" style="width: 50%" /></div>
                                    <div class="span3">
                                        <input id="H4" type="text" style="width: 50%" /></div>
                                    <div class="span3">
                                        <input id="F4" onfocus="Verificar(4)" type="text" style="width: 50%" value="0.0"/></div>
                                    <div class="span3" id="B4"><a href="javascript:void(0)" class="btn btn-inverse" onclick="Cambiar(4,5)" style="color: #E6F0F2">+</a></div>
                                </div>
                                <div id="div5" class="row-fluid" style="display: none">
                                    <div class="span3">
                                        <input id="D5" disabled="disabled"  type="text" style="width: 50%" /></div>
                                    <div class="span3">
                                        <input id="H5" type="text" style="width: 50%" /></div>
                                    <div class="span3">
                                        <input id="F5" onfocus="Verificar(5)" type="text" style="width: 50%" value="0.0"/></div>
                                    <div class="span3" id="B5"><a href="javascript:void(0)" class="btn btn-inverse" onclick="Cambiar(5,6)" style="color: #E6F0F2">+</a></div>
                                </div>
                                <br />
                                <div style="visibility: hidden">@Html.Telerik().AutoCompleteFor(m => m.ParamsIN[3].nombre)</div>
                            </div>
                            <div class="span12">
                                <div class="span6"><a id="calcular" style="color: #E6F0F2" class="btn btn-inverse">Calcular</a></div>
                                <div class="span6"><a class="btn btn-inverse" style="color: #E6F0F2" href="@Url.Action("Index", "ParametrosSencibles", new { Area = "Simulaciones", idProyecto = ViewBag.ProyectoId })">Regresar</a></div>
                            </div>
                            <script type="text/javascript">
                                $("#calcular").click(function () {
                                    var ant = $("#ParamsIN_3__nombre").val();
                                    var media = $("#ParamsIN_0__valorD").val();
                                    var muestras = $("#ParamsIN_2__valorI").val();
                                    if (ant == "Precision")
                                        alert("Seleccione el Boton + para asignar")

                                    $.ajax({
                                        url: '/Simulaciones/Normal/Index2',
                                        data: { precision: media + "*" + muestras + "*" + ant },
                                        type: 'post',
                                        success: function (data) {
                                            location.reload();
                                        }
                                    });
                                });
                            </script>
                        }
                    </div>
                </div>
            </div>
        </div>
        @*Formulas*@
        <div class="row-fluid">
            <div class="span12">
                <div class="portlet box black">
                    <div class="portlet-title">
                        <h4>Fórmulas</h4>
                        <div class="portlet-body">
                            <table class="table table-hover">
                                <tr>
                                    <td>@Model.Formulates[0].NombreFormula</td>
                                    <td>
                                        <img alt="@Model.Formulates[0].NombreFormula" src="@Url.Action("getImg", "Normal", new { Id = 0 })" height="10" width="20" class="item" /></td>
                                </tr>
                                <tr>
                                    <td>@Model.Formulates[1].NombreFormula</td>
                                    <td>
                                        <img alt="@Model.Formulates[1].NombreFormula" src="@Url.Action("getImg", "Normal", new { Id = 1 })" height="10" width="30" class="item" /></td>
                                </tr>
                                <tr>
                                    <td>@Model.Formulates[2].NombreFormula</td>
                                    <td>
                                        <img alt="@Model.Formulates[2].NombreFormula" src="@Url.Action("getImg", "Normal", new { Id = 2 })" height="10" width="10" class="item" /></td>
                                </tr>
                                <tr>
                                    <td>@Model.Formulates[3].NombreFormula</td>
                                    <td>
                                        <img alt="@Model.Formulates[3].NombreFormula" src="@Url.Action("getImg", "Normal", new { Id = 3 })" height="60" width="100" class="item" /></td>
                                </tr>

                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        @*Caracteristicas*@
        <div class="row-fluid">
            <div class="span12">
                <div class="portlet box black">
                    <div class="portlet-title">
                        <h4>Características</h4>
                        <div class="portlet-body">
                            <table class="table table-hover">
                                <tbody>
                                    <tr>
                                        <td>@Model.ParamsOUT[0].nombre</td>
                                        <td>@Html.Telerik().IntegerTextBoxFor(m => m.ParamsOUT[0].valorI).InputHtmlAttributes(new { style = "width: 50;" }).Enable(false)</td>
                                        <td>@Model.ParamsOUT[0].rango</td>
                                    </tr>
                                    <tr>
                                        <td>@Model.ParamsOUT[1].nombre</td>
                                        <td>@Html.Telerik().IntegerTextBoxFor(m => m.ParamsOUT[1].valorI).InputHtmlAttributes(new { style = "width: 50;" }).Enable(false)</td>
                                        <td>@Model.ParamsOUT[1].rango</td>
                                    </tr>
                                    <tr>
                                        <td>@Model.ParamsOUT[2].nombre</td>
                                        <td>@Html.Telerik().NumericTextBoxFor(m => m.ParamsOUT[2].valorD).InputHtmlAttributes(new { style = "width: 50;" }).Enable(false)</td>
                                        <td>@Model.ParamsOUT[2].rango</td>
                                    </tr>
                                    <tr>
                                        <td>@Model.ParamsOUT[3].nombre</td>
                                        <td>@Html.Telerik().IntegerTextBoxFor(m => m.ParamsOUT[3].valorI).InputHtmlAttributes(new { style = "width: 50;" }).Enable(false)</td>
                                        <td>@Model.ParamsOUT[3].rango</td>
                                    </tr>
                                    <tr>
                                        <td>@Model.ParamsOUT[4].nombre</td>
                                        <td>@Html.Telerik().IntegerTextBoxFor(m => m.ParamsOUT[4].valorI).InputHtmlAttributes(new { style = "width: 50;" }).Enable(false)</td>
                                        <td>@Model.ParamsOUT[4].rango</td>
                                    </tr>
                                    <tr>
                                        <td>@Model.ParamsOUT[5].nombre</td>
                                        <td>@Html.Telerik().NumericTextBoxFor(m => m.ParamsOUT[6].valorD).InputHtmlAttributes(new { style = "width: 50;" }).Enable(false)</td>
                                        <td>@Model.ParamsOUT[5].rango</td>
                                    </tr>
                                    <tr>
                                        <td>@Model.ParamsOUT[6].nombre</td>
                                        <td>@Html.Telerik().NumericTextBoxFor(m => m.ParamsOUT[6].valorD).InputHtmlAttributes(new { style = "width: 50;" }).Enable(false)</td>
                                        <td>@Model.ParamsOUT[6].rango</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="span8">
        <div class="row-fluid">
            <div class="span6" style="text-align: center">
                @{Html.RenderAction("_GraficoProbabilidad", "Normal");}
            </div>
            <div class="span6" style="text-align: center">
                @{Html.RenderAction("_GraficoMuestra", "Normal");}
            </div>
        </div>
        <div class="row-fluid">
            <div class="span12" style="text-align: center">
                @{Html.RenderAction("_Resumen", "Normal");}
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">

    function Verificar(a) {
        var D = "#D" + a;
        var H = "#H" + a;
        var DN=parseInt($(D).val());
        var HN=parseInt($(H).val());
        if (HN < DN) {
            alert("Los valores ingresados deben ser incrementales");
        }

    }

    function Cambiar(a, b) {
        var ant = $("#ParamsIN_3__nombre").val();
        var D = "#D" + a;
        var H = "#H" + a;
        var __a = parseFloat($("#F1").val()) + parseFloat($("#F2").val()) + parseFloat($("#F3").val()) + parseFloat($("#F4").val()) + parseFloat($("#F5").val())
        
        var DN = parseInt($(D).val());
        var HN = parseInt($(H).val());
        if (HN < DN) {
            alert("Los valores ingresados deben ser incrementales");
        } else {
            if (ant == "Precision")
                ant = "";

            var divb = "#div" + b;
            if (parseFloat(__a).toFixed(2) < 1.00) {
                $(divb).show()
            }
            var boton = "#B" + a;
            $(boton).hide();
            var DD = $(D).val();
            var HH = $(H).val();
            var F = "#F" + a;
            var FF = $(F).val();
            $("#D" + b).val($("#H" + a).val());
            var _a = parseFloat($("#F1").val()) + parseFloat($("#F2").val()) + parseFloat($("#F3").val()) + parseFloat($("#F4").val()) + parseFloat($("#F5").val())
            $("#F"+b).val(parseFloat(1 - _a).toFixed(2))

            if (ant == "")
                $("#ParamsIN_3__nombre").val(DD + "|" + HH + "|" + FF);
            else
                $("#ParamsIN_3__nombre").val(DD + "|" + HH + "|" + FF + "=" + ant);
        }

    }

</script>
